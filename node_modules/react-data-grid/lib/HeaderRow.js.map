{"version":3,"file":"HeaderRow.js","sourceRoot":"","sources":["../src/HeaderRow.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\n\nimport HeaderCell from './HeaderCell';\nimport SortableHeaderCell from './common/cells/headerCells/SortableHeaderCell';\nimport FilterableHeaderCell from './common/cells/headerCells/FilterableHeaderCell';\nimport { isFrozen } from './utils/columnUtils';\nimport { isPositionStickySupported } from './utils';\nimport { HeaderRowType, HeaderCellType, DEFINE_SORT } from './common/enums';\nimport { CalculatedColumn, AddFilterEvent } from './common/types';\nimport { HeaderProps } from './Header';\n\ntype SharedHeaderProps<R, K extends keyof R> = Pick<HeaderProps<R, K>,\n| 'draggableHeaderCell'\n| 'onHeaderDrop'\n| 'allRowsSelected'\n| 'sortColumn'\n| 'sortDirection'\n| 'onSort'\n| 'getValidFilterValues'\n>;\n\nexport interface HeaderRowProps<R, K extends keyof R> extends SharedHeaderProps<R, K> {\n  width: number;\n  height: number;\n  columns: CalculatedColumn<R>[];\n  lastFrozenColumnIndex: number;\n  onColumnResize(column: CalculatedColumn<R>, width: number): void;\n  onAllRowsSelectionChange(checked: boolean): void;\n  filterable?: boolean;\n  onFilterChange?(args: AddFilterEvent<R>): void;\n  rowType: HeaderRowType;\n}\n\nexport default class HeaderRow<R, K extends keyof R> extends React.Component<HeaderRowProps<R, K>> {\n  static displayName = 'HeaderRow';\n\n  private readonly cells = new Map<keyof R, HeaderCell<R>>();\n\n  getHeaderCellType(column: CalculatedColumn<R>): HeaderCellType {\n    if (column.filterable && this.props.filterable) {\n      return HeaderCellType.FILTERABLE;\n    }\n\n    if (column.sortable && this.props.rowType !== HeaderRowType.FILTER) {\n      return HeaderCellType.SORTABLE;\n    }\n\n    return HeaderCellType.NONE;\n  }\n\n  getFilterableHeaderCell(column: CalculatedColumn<R>) {\n    const FilterRenderer = column.filterRenderer || FilterableHeaderCell;\n    return (\n      <FilterRenderer<R>\n        column={column}\n        onChange={this.props.onFilterChange}\n        getValidFilterValues={this.props.getValidFilterValues}\n      />\n    );\n  }\n\n  getSortableHeaderCell(column: CalculatedColumn<R>) {\n    const sortDirection = this.props.sortColumn === column.key && this.props.sortDirection || DEFINE_SORT.NONE;\n    const sortDescendingFirst = column.sortDescendingFirst || false;\n    return (\n      <SortableHeaderCell<R>\n        column={column}\n        rowType={this.props.rowType}\n        onSort={this.props.onSort}\n        sortDirection={sortDirection}\n        sortDescendingFirst={sortDescendingFirst}\n        allRowsSelected={this.props.allRowsSelected}\n        onAllRowsSelectionChange={this.props.onAllRowsSelectionChange}\n      />\n    );\n  }\n\n  getHeaderRenderer(column: CalculatedColumn<R>) {\n    if (column.headerRenderer && !column.sortable && !this.props.filterable) {\n      return column.headerRenderer;\n    }\n    const headerCellType = this.getHeaderCellType(column);\n    switch (headerCellType) {\n      case HeaderCellType.SORTABLE:\n        return this.getSortableHeaderCell(column);\n      case HeaderCellType.FILTERABLE:\n        return this.getFilterableHeaderCell(column);\n      default:\n        return undefined;\n    }\n  }\n\n  getCells() {\n    const cellElements = [];\n    const { columns, lastFrozenColumnIndex, rowType } = this.props;\n    const setRef = !isPositionStickySupported();\n\n    for (const column of columns) {\n      const { key } = column;\n      const renderer = key === 'select-row' && rowType === HeaderRowType.FILTER ? <div /> : this.getHeaderRenderer(column);\n\n      cellElements.push(\n        <HeaderCell<R>\n          key={key as string}\n          ref={setRef\n            ? node => node ? this.cells.set(key, node) : this.cells.delete(key)\n            : undefined}\n          column={column}\n          lastFrozenColumnIndex={lastFrozenColumnIndex}\n          rowType={rowType}\n          height={this.props.height}\n          renderer={renderer}\n          onResize={this.props.onColumnResize}\n          onHeaderDrop={this.props.onHeaderDrop}\n          allRowsSelected={this.props.allRowsSelected}\n          onAllRowsSelectionChange={this.props.onAllRowsSelectionChange}\n          draggableHeaderCell={this.props.draggableHeaderCell}\n        />\n      );\n    }\n\n    return cellElements;\n  }\n\n  setScrollLeft(scrollLeft: number): void {\n    this.props.columns.forEach(column => {\n      const { key } = column;\n      if (!this.cells.has(key)) return;\n      const cell = this.cells.get(key)!;\n      if (isFrozen(column)) {\n        cell.setScrollLeft(scrollLeft);\n      } else {\n        cell.removeScroll();\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div\n        className=\"rdg-header-row\"\n        style={{ width: this.props.width, height: this.props.height, lineHeight: `${this.props.height}px` }}\n      >\n        {this.getCells()}\n      </div>\n    );\n  }\n}\n"]}